wybuntu@Wyatt-Lat7490:~/hubtube$ php vendor/bin/pest --testsuite=Feature

   PASS  Tests\Feature\AdminPanelTest
  ✓ guest cannot access admin panel                                                                              1.14s
  ✓ regular user cannot access admin panel                                                                       0.14s
  ✓ admin user can access admin panel                                                                            0.37s
  ✓ guest cannot access horizon dashboard                                                                        0.05s

   PASS  Tests\Feature\ApiTest
  ✓ unauthenticated API user request returns 401                                                                 0.06s
  ✓ authenticated API user returns user data                                                                     0.05s
  ✓ API search endpoint is publicly accessible                                                                   0.05s
  ✓ API wallet transactions require auth                                                                         0.04s
  ✓ translation API returns languages                                                                            0.04s

   PASS  Tests\Feature\AuthTest
  ✓ registration page loads for guests                                                                           0.05s
  ✓ login page loads for guests                                                                                  0.04s
  ✓ user can register with valid data                                                                            0.24s
  ✓ registration fails with duplicate email                                                                      0.05s
  ✓ registration fails with duplicate username                                                                   0.05s
  ✓ user can login with valid credentials                                                                        0.06s
  ✓ login fails with wrong password                                                                              0.25s
  ✓ authenticated user can logout                                                                                0.05s
  ✓ forgot password page loads                                                                                   0.05s
  ✓ authenticated users cannot access login page                                                                 0.04s
  ✓ authenticated users cannot access register page                                                              0.04s

   FAIL  Tests\Feature\CommentTest
  ✓ authenticated user can post a comment                                                                        0.07s
  ✓ guest cannot post a comment                                                                                  0.05s
  ✓ comment requires content                                                                                     0.05s
  ⨯ comment owner can update their comment                                                                       0.07s
  ✓ non-owner cannot update comment                                                                              0.06s
  ⨯ comment owner can delete their comment                                                                       0.05s
  ⨯ authenticated user can like a comment                                                                        0.06s

   PASS  Tests\Feature\ContactTest
  ✓ contact page loads                                                                                           0.06s
  ✓ contact form requires valid data                                                                             0.04s
  ✓ contact form submits with valid data                                                                         0.05s

   FAIL  Tests\Feature\PlaylistTest
  ✓ guest cannot access playlists page                                                                           0.05s
  ✓ authenticated user can access playlists page                                                                 0.06s
  ✓ authenticated user can create a playlist                                                                     0.05s
  ⨯ playlist owner can update playlist                                                                           0.05s
  ✓ playlist owner can delete playlist                                                                           0.09s
  ✓ non-owner cannot delete playlist                                                                             0.05s
  ✓ public playlist page loads for guests                                                                        0.05s
  ⨯ authenticated user can add video to playlist                                                                 0.06s
  ⨯ authenticated user can remove video from playlist                                                            0.05s

   WARN  Tests\Feature\ProductionReadinessTest
  ✓ APP_KEY is set and not the default                                                                           0.03s
  ✓ APP_ENV is not set to local in production                                                                    0.02s
  ✓ APP_DEBUG should be false in production                                                                      0.02s
  ✓ APP_URL is configured                                                                                        0.02s
  ✓ timezone is set                                                                                              0.02s
  ✓ app locale is set                                                                                            0.02s
  ✓ database connection works                                                                                    0.02s
  ✓ migrations are up to date                                                                                    0.04s
  ✓ users table exists                                                                                           0.02s
  ✓ videos table exists                                                                                          0.02s
  ✓ categories table exists                                                                                      0.02s
  ✓ settings table exists                                                                                        0.02s
  ✓ comments table exists                                                                                        0.02s
  ✓ playlists table exists                                                                                       0.02s
  ✓ subscriptions table exists                                                                                   0.02s
  ✓ video_ads table exists                                                                                       0.03s
  ✓ translations table exists                                                                                    0.02s
  ✓ cache driver is configured                                                                                   0.02s
  ✓ session driver is configured                                                                                 0.02s
  ✓ queue driver is configured                                                                                   0.02s
  ✓ cache operations work                                                                                        0.02s
  - bcrypt rounds are at least 10 → Bcrypt rounds intentionally lowered in testing env                           0.02s
  ✓ session cookie is configured securely                                                                        0.02s
  ✓ CSRF protection is enabled                                                                                   0.05s
  ✓ storage/installed marker file exists                                                                         0.02s
  ✓ storage directory is writable                                                                                0.02s
  ✓ storage/logs directory exists                                                                                0.02s
  ✓ bootstrap/cache directory is writable                                                                        0.02s
  ✓ public/index.php exists                                                                                      0.03s
  ✓ public storage symlink exists                                                                                0.02s
  ✓ sentry config exists                                                                                         0.02s
  ✓ hubtube config exists                                                                                        0.02s
  ✓ horizon config exists                                                                                        0.02s
  ✓ video allowed extensions are configured                                                                      0.02s
  ✓ video qualities are configured                                                                               0.03s
  ✓ mail from address is configured                                                                              0.02s
  ✓ mail from name is configured                                                                                 0.02s
  ✓ setting model can read and write                                                                             0.02s
  ✓ encrypted settings work correctly                                                                            0.02s
  ✓ all critical named routes are registered                                                                     0.02s
  ✓ locale-prefixed routes are registered                                                                        0.02s
  ✓ security headers middleware is registered                                                                    0.02s
  ✓ age verification middleware is registered                                                                    0.02s
  ✓ set locale middleware is registered                                                                          0.02s
  ✓ check installed middleware is registered                                                                     0.03s
  ✓ SeoService class exists                                                                                      0.02s
  ✓ VideoService class exists                                                                                    0.02s
  ✓ StorageManager class exists                                                                                  0.02s
  ✓ TranslationService class exists                                                                              0.02s
  ✓ WalletService class exists                                                                                   0.02s
  ✓ artisan optimize runs without error                                                                          0.07s
  ✓ artisan route:list runs without error                                                                        0.05s

   PASS  Tests\Feature\PublicRoutesTest
  ✓ homepage loads successfully                                                                                  0.10s
  ✓ trending page loads successfully                                                                             0.05s
  ✓ shorts page loads successfully                                                                               0.05s
  ✓ search page loads successfully                                                                               0.05s
  ✓ search page accepts query parameter                                                                          0.05s
  ✓ categories page loads successfully                                                                           0.05s
  ✓ category page loads with valid category                                                                      0.05s
  ✓ video page loads with valid video                                                                            0.06s
  ✓ video page returns 404 for non-existent slug                                                                 0.06s
  ✓ channel page loads with valid user                                                                           0.05s
  ✓ channel videos tab loads                                                                                     0.05s
  ✓ channel about tab loads                                                                                      0.05s
  ✓ contact page loads successfully                                                                              0.04s
  ✓ live streams page loads successfully                                                                         0.05s
  ✓ videos index page loads successfully                                                                         0.05s
  ✓ offline page loads for PWA                                                                                   0.04s
  ✓ health check endpoint returns 200                                                                            0.04s

   PASS  Tests\Feature\SecurityHeadersTest
  ✓ response includes Content-Security-Policy header                                                             0.07s
  ✓ response includes X-Content-Type-Options header                                                              0.05s
  ✓ response includes X-Frame-Options header                                                                     0.05s
  ✓ response includes X-XSS-Protection header                                                                    0.05s
  ✓ response includes Referrer-Policy header                                                                     0.05s
  ✓ response includes Permissions-Policy header                                                                  0.06s

   PASS  Tests\Feature\SeoTest
  ✓ sitemap.xml returns valid XML                                                                                0.05s
  ✓ robots.txt returns plain text                                                                                0.04s
  ✓ homepage returns Inertia response with seo prop                                                              0.06s
  ✓ video page returns Inertia response with seo prop                                                            0.07s
  ✓ category page returns Inertia response with seo prop                                                         0.06s
  ✓ channel page returns Inertia response with seo prop                                                          0.06s
  ✓ locale-prefixed homepage loads                                                                               0.05s
  ✓ locale-prefixed trending loads                                                                               0.05s

   FAIL  Tests\Feature\SubscriptionTest
  ⨯ authenticated user can subscribe to a channel                                                                0.37s
  ⨯ authenticated user can unsubscribe from a channel                                                            0.22s
  ✓ guest cannot subscribe to a channel                                                                          0.05s
  ⨯ user cannot subscribe to themselves                                                                          0.05s

   FAIL  Tests\Feature\UserSettingsTest
  ✓ guest cannot access settings page                                                                            0.06s
  ✓ authenticated user can access settings page                                                                  0.06s
  ⨯ user can update profile                                                                                      0.06s
  ✓ user can update password                                                                                     0.06s
  ✓ password update fails with wrong current password                                                            0.06s
  ✓ guest cannot access dashboard                                                                                0.05s
  ✓ authenticated user can access dashboard                                                                      0.06s
  ✓ guest cannot access feed                                                                                     0.05s
  ✓ authenticated user can access feed                                                                           0.06s
  ✓ guest cannot access history                                                                                  0.05s
  ✓ authenticated user can access history                                                                        0.07s
  ✓ guest cannot access notifications                                                                            0.05s
  ✓ authenticated user can access notifications                                                                  0.05s
  ✓ guest cannot access wallet                                                                                   0.05s
  ✓ authenticated user can access wallet                                                                         0.06s

   FAIL  Tests\Feature\VideoTest
  ✓ guest cannot access upload page                                                                              0.07s
  ✓ authenticated user can access upload page                                                                    0.06s
  ✓ public video is visible to guests                                                                            0.06s
  ✓ private video returns 403 for non-owner                                                                      0.07s
  ✓ private video is accessible by owner                                                                         0.11s
  ⨯ video owner can access edit page                                                                             0.08s
  ✓ non-owner cannot access video edit page                                                                      0.07s
  ⨯ video owner can update video                                                                                 0.06s
  ✓ video owner can delete video                                                                                 0.06s
  ✓ non-owner cannot delete video                                                                                0.07s
  ⨯ authenticated user can like a video                                                                          0.06s
  ⨯ authenticated user can dislike a video                                                                       0.07s
  ✓ load more videos API returns JSON                                                                            0.07s
  ✓ video ads API returns JSON                                                                                   0.05s
  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\CommentTest > comment owner can update their comment
  Expected response status code [201, 301, 302, 303, 307, 308] but received 200.
Failed asserting that false is true.

  at tests/Feature/CommentTest.php:59
     55▕     $response = $this->put("/comments/{$comment->id}", [
     56▕         'content' => 'Updated comment text.',
     57▕     ]);
     58▕
  ➜  59▕     $response->assertRedirect();
     60▕     expect($comment->fresh()->content)->toBe('Updated comment text.');
     61▕ });
     62▕
     63▕ test('non-owner cannot update comment', function () {

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\CommentTest > comment owner can delete their comment
  Expected response status code [201, 301, 302, 303, 307, 308] but received 200.
Failed asserting that false is true.

  at tests/Feature/CommentTest.php:77
     73▕     $user = asUser();
     74▕     $comment = Comment::factory()->create(['user_id' => $user->id]);
     75▕
     76▕     $response = $this->delete("/comments/{$comment->id}");
  ➜  77▕     $response->assertRedirect();
     78▕     $this->assertSoftDeleted('comments', ['id' => $comment->id]);
     79▕ });
     80▕
     81▕ test('authenticated user can like a comment', function () {

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\CommentTest > authenticated user can like a comment
  Expected response status code [201, 301, 302, 303, 307, 308] but received 200.
Failed asserting that false is true.

  at tests/Feature/CommentTest.php:86
     82▕     asUser();
     83▕     $comment = Comment::factory()->create();
     84▕
     85▕     $response = $this->post("/comments/{$comment->id}/like");
  ➜  86▕     $response->assertRedirect();
     87▕ });
     88▕

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PlaylistTest > playlist owner can update playlist
  Expected response status code [201, 301, 302, 303, 307, 308] but received 200.
Failed asserting that false is true.

  at tests/Feature/PlaylistTest.php:47
     43▕         'description' => 'Updated description',
     44▕         'privacy' => 'private',
     45▕     ]);
     46▕
  ➜  47▕     $response->assertRedirect();
     48▕     expect($playlist->fresh()->title)->toBe('Updated Playlist');
     49▕ });
     50▕
     51▕ test('playlist owner can delete playlist', function () {

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PlaylistTest > authenticated user can add video to playlist
  Expected response status code [201, 301, 302, 303, 307, 308] but received 200.
Failed asserting that false is true.

  at tests/Feature/PlaylistTest.php:81
     77▕     $response = $this->post("/playlists/{$playlist->id}/videos", [
     78▕         'video_id' => $video->id,
     79▕     ]);
     80▕
  ➜  81▕     $response->assertRedirect();
     82▕ });
     83▕
     84▕ test('authenticated user can remove video from playlist', function () {
     85▕     $user = asUser();

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PlaylistTest > authenticated user can remove video from playlist
  Expected response status code [201, 301, 302, 303, 307, 308] but received 200.
Failed asserting that false is true.

  at tests/Feature/PlaylistTest.php:94
     90▕     $response = $this->delete("/playlists/{$playlist->id}/videos", [
     91▕         'video_id' => $video->id,
     92▕     ]);
     93▕
  ➜  94▕     $response->assertRedirect();
     95▕ });
     96▕

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\SubscriptionTest > authenticated user can subscribe to a channel
  Expected response status code [201, 301, 302, 303, 307, 308] but received 500.
Failed asserting that false is true.

The following exception occurred during the last request:

Illuminate\Broadcasting\BroadcastException: Pusher error: cURL error 7: Failed to connect to localhost port 8080 after 1 ms: Connection refused (see https://curl.haxx.se/libcurl/c/libcurl-errors.html) for http://localhost:8080/apps/hubtube/events?auth_key=hubtube-key&auth_timestamp=1770923076&auth_version=1.0&body_md5=428086f2f0c5841df225d24e9fd47de5&auth_signature=96976373275c91a75f460b735187db24f5fa98791fefd07d53bcc2a00f0a179e. in /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Broadcasting/Broadcasters/PusherBroadcaster.php:164
Stack trace:
#0 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Broadcasting/BroadcastEvent.php(93): Illuminate\Broadcasting\Broadcasters\PusherBroadcaster->broadcast()
#1 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(36): Illuminate\Broadcasting\BroadcastEvent->handle()
#2 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Container/Util.php(43): Illuminate\Container\BoundMethod::{closure:Illuminate\Container\BoundMethod::call():35}()
#3 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(95): Illuminate\Container\Util::unwrapIfClosure()
#4 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(35): Illuminate\Container\BoundMethod::callBoundMethod()
#5 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Container/Container.php(696): Illuminate\Container\BoundMethod::call()
#6 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Bus/Dispatcher.php(126): Illuminate\Container\Container->call()
#7 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Bus\Dispatcher->{closure:Illuminate\Bus\Dispatcher::dispatchNow():123}()
#8 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():168}()
#9 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Bus/Dispatcher.php(130): Illuminate\Pipeline\Pipeline->then()
#10 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/CallQueuedHandler.php(126): Illuminate\Bus\Dispatcher->dispatchNow()
#11 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Queue\CallQueuedHandler->{closure:Illuminate\Queue\CallQueuedHandler::dispatchThroughMiddleware():121}()
#12 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():168}()
#13 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/CallQueuedHandler.php(121): Illuminate\Pipeline\Pipeline->then()
#14 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/CallQueuedHandler.php(69): Illuminate\Queue\CallQueuedHandler->dispatchThroughMiddleware()
#15 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/Jobs/Job.php(102): Illuminate\Queue\CallQueuedHandler->call()
#16 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/SyncQueue.php(76): Illuminate\Queue\Jobs\Job->fire()
#17 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/SyncQueue.php(56): Illuminate\Queue\SyncQueue->executeJob()
#18 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/Queue.php(59): Illuminate\Queue\SyncQueue->push()
#19 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Broadcasting/BroadcastManager.php(207): Illuminate\Queue\Queue->pushOn()
#20 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Events/Dispatcher.php(358): Illuminate\Broadcasting\BroadcastManager->queue()
#21 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Events/Dispatcher.php(281): Illuminate\Events\Dispatcher->broadcastEvent()
#22 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Events/Dispatcher.php(267): Illuminate\Events\Dispatcher->invokeListeners()
#23 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/helpers.php(473): Illuminate\Events\Dispatcher->dispatch()
#24 /home/wybuntu/hubtube/app/Http/Controllers/SubscriptionController.php(26): event()
#25 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Controller.php(54): App\Http\Controllers\SubscriptionController->store()
#26 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(44): Illuminate\Routing\Controller->callAction()
#27 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Route.php(266): Illuminate\Routing\ControllerDispatcher->dispatch()
#28 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Route.php(212): Illuminate\Routing\Route->runController()
#29 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Router.php(808): Illuminate\Routing\Route->run()
#30 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->{closure:Illuminate\Routing\Router::runRouteWithinStack():807}()
#31 /home/wybuntu/hubtube/app/Http/Middleware/AgeVerification.php(28): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():168}()
#32 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): App\Http\Middleware\AgeVerification->handle()
#33 /home/wybuntu/hubtube/app/Http/Middleware/CheckInstalled.php(31): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#34 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): App\Http\Middleware\CheckInstalled->handle()
#35 /home/wybuntu/hubtube/app/Http/Middleware/AddSecurityHeaders.php(13): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#36 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): App\Http\Middleware\AddSecurityHeaders->handle()
#37 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Http/Middleware/AddLinkHeadersForPreloadedAssets.php(20): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#38 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\AddLinkHeadersForPreloadedAssets->handle()
#39 /home/wybuntu/hubtube/vendor/inertiajs/inertia-laravel/src/Middleware.php(87): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#40 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Inertia\Middleware->handle()
#41 /home/wybuntu/hubtube/app/Http/Middleware/SetLocale.php(51): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#42 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): App\Http\Middleware\SetLocale->handle()
#43 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#44 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#45 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#46 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#47 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#48 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#49 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#50 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#51 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#52 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#53 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#54 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#55 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#56 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#57 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#58 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#59 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#60 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#61 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#62 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#63 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#64 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->{closure:Illuminate\Foundation\Http\Kernel::dispatchToRouter():198}()
#65 /home/wybuntu/hubtube/vendor/livewire/livewire/src/Features/SupportDisablingBackButtonCache/DisableBackButtonCacheMiddleware.php(19): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():168}()
#66 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Livewire\Features\SupportDisablingBackButtonCache\DisableBackButtonCacheMiddleware->handle()
#67 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#68 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#69 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#70 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#71 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#72 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#73 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#74 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#75 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#76 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#77 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#78 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#79 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#80 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#81 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#82 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#83 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#84 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#85 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#86 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#87 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(397): Illuminate\Foundation\Testing\TestCase->call()
#88 /home/wybuntu/hubtube/tests/Feature/SubscriptionTest.php(15): Illuminate\Foundation\Testing\TestCase->post()
#89 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Factories/TestCaseMethodFactory.php(110): P\Tests\Feature\SubscriptionTest->{closure:/home/wybuntu/hubtube/tests/Feature/SubscriptionTest.php:11}()
#90 [internal function]: P\Tests\Feature\SubscriptionTest->{closure:Pest\Factories\TestCaseMethodFactory::getClosure():102}()
#91 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Concerns/Testable.php(339): call_user_func_array()
#92 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Support/ExceptionTrace.php(26): P\Tests\Feature\SubscriptionTest->{closure:Pest\Concerns\Testable::__callClosure():339}()
#93 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Concerns/Testable.php(339): Pest\Support\ExceptionTrace::ensure()
#94 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Concerns/Testable.php(256): P\Tests\Feature\SubscriptionTest->__callClosure()
#95 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Factories/TestCaseFactory.php(197) : eval()'d code(26): P\Tests\Feature\SubscriptionTest->__runTest()
#96 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestCase.php(1548): P\Tests\Feature\SubscriptionTest->__pest_evaluable_authenticated_user_can_subscribe_to_a_channel()
#97 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestCase.php(686): PHPUnit\Framework\TestCase->runTest()
#98 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#99 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestCase.php(516): PHPUnit\Framework\TestRunner->run()
#100 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestCase->run()
#101 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestSuite->run()
#102 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestSuite->run()
#103 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#104 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/TextUI/Application.php(204): PHPUnit\TextUI\TestRunner->run()
#105 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Kernel.php(103): PHPUnit\TextUI\Application->run()
#106 /home/wybuntu/hubtube/vendor/pestphp/pest/bin/pest(91): Pest\Kernel->handle()
#107 /home/wybuntu/hubtube/vendor/pestphp/pest/bin/pest(99): {closure:/home/wybuntu/hubtube/vendor/pestphp/pest/bin/pest:12}()
#108 /home/wybuntu/hubtube/vendor/bin/pest(119): include('...')
#109 {main}

----------------------------------------------------------------------------------

Pusher error: cURL error 7: Failed to connect to localhost port 8080 after 1 ms: Connection refused (see https://curl.haxx.se/libcurl/c/libcurl-errors.html) for http://localhost:8080/apps/hubtube/events?auth_key=hubtube-key&auth_timestamp=1770923076&auth_version=1.0&body_md5=428086f2f0c5841df225d24e9fd47de5&auth_signature=96976373275c91a75f460b735187db24f5fa98791fefd07d53bcc2a00f0a179e.

  at tests/Feature/SubscriptionTest.php:16
     12▕     $subscriber = asUser();
     13▕     $channel = User::factory()->create();
     14▕
     15▕     $response = $this->post("/channel/{$channel->id}/subscribe");
  ➜  16▕     $response->assertRedirect();
     17▕
     18▕     $this->assertDatabaseHas('subscriptions', [
     19▕         'subscriber_id' => $subscriber->id,
     20▕         'channel_id' => $channel->id,

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\SubscriptionTest > authenticated user can unsubscribe from a channel
  Expected response status code [201, 301, 302, 303, 307, 308] but received 200.
Failed asserting that false is true.

The following exception occurred during the last request:

Illuminate\Broadcasting\BroadcastException: Pusher error: cURL error 7: Failed to connect to localhost port 8080 after 0 ms: Connection refused (see https://curl.haxx.se/libcurl/c/libcurl-errors.html) for http://localhost:8080/apps/hubtube/events?auth_key=hubtube-key&auth_timestamp=1770923077&auth_version=1.0&body_md5=6d6abf0237bc375009866e2f688197ca&auth_signature=054db8becd1729cd9aef5e37e97c01252d5e504a9599306a85e287434494b338. in /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Broadcasting/Broadcasters/PusherBroadcaster.php:164
Stack trace:
#0 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Broadcasting/BroadcastEvent.php(93): Illuminate\Broadcasting\Broadcasters\PusherBroadcaster->broadcast()
#1 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(36): Illuminate\Broadcasting\BroadcastEvent->handle()
#2 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Container/Util.php(43): Illuminate\Container\BoundMethod::{closure:Illuminate\Container\BoundMethod::call():35}()
#3 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(95): Illuminate\Container\Util::unwrapIfClosure()
#4 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(35): Illuminate\Container\BoundMethod::callBoundMethod()
#5 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Container/Container.php(696): Illuminate\Container\BoundMethod::call()
#6 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Bus/Dispatcher.php(126): Illuminate\Container\Container->call()
#7 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Bus\Dispatcher->{closure:Illuminate\Bus\Dispatcher::dispatchNow():123}()
#8 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():168}()
#9 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Bus/Dispatcher.php(130): Illuminate\Pipeline\Pipeline->then()
#10 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/CallQueuedHandler.php(126): Illuminate\Bus\Dispatcher->dispatchNow()
#11 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Queue\CallQueuedHandler->{closure:Illuminate\Queue\CallQueuedHandler::dispatchThroughMiddleware():121}()
#12 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():168}()
#13 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/CallQueuedHandler.php(121): Illuminate\Pipeline\Pipeline->then()
#14 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/CallQueuedHandler.php(69): Illuminate\Queue\CallQueuedHandler->dispatchThroughMiddleware()
#15 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/Jobs/Job.php(102): Illuminate\Queue\CallQueuedHandler->call()
#16 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/SyncQueue.php(76): Illuminate\Queue\Jobs\Job->fire()
#17 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/SyncQueue.php(56): Illuminate\Queue\SyncQueue->executeJob()
#18 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Queue/Queue.php(59): Illuminate\Queue\SyncQueue->push()
#19 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Broadcasting/BroadcastManager.php(207): Illuminate\Queue\Queue->pushOn()
#20 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Events/Dispatcher.php(358): Illuminate\Broadcasting\BroadcastManager->queue()
#21 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Events/Dispatcher.php(281): Illuminate\Events\Dispatcher->broadcastEvent()
#22 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Events/Dispatcher.php(267): Illuminate\Events\Dispatcher->invokeListeners()
#23 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/helpers.php(473): Illuminate\Events\Dispatcher->dispatch()
#24 /home/wybuntu/hubtube/app/Http/Controllers/SubscriptionController.php(26): event()
#25 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Controller.php(54): App\Http\Controllers\SubscriptionController->store()
#26 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(44): Illuminate\Routing\Controller->callAction()
#27 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Route.php(266): Illuminate\Routing\ControllerDispatcher->dispatch()
#28 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Route.php(212): Illuminate\Routing\Route->runController()
#29 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Router.php(808): Illuminate\Routing\Route->run()
#30 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->{closure:Illuminate\Routing\Router::runRouteWithinStack():807}()
#31 /home/wybuntu/hubtube/app/Http/Middleware/AgeVerification.php(28): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():168}()
#32 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): App\Http\Middleware\AgeVerification->handle()
#33 /home/wybuntu/hubtube/app/Http/Middleware/CheckInstalled.php(31): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#34 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): App\Http\Middleware\CheckInstalled->handle()
#35 /home/wybuntu/hubtube/app/Http/Middleware/AddSecurityHeaders.php(13): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#36 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): App\Http\Middleware\AddSecurityHeaders->handle()
#37 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Http/Middleware/AddLinkHeadersForPreloadedAssets.php(20): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#38 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\AddLinkHeadersForPreloadedAssets->handle()
#39 /home/wybuntu/hubtube/vendor/inertiajs/inertia-laravel/src/Middleware.php(87): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#40 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Inertia\Middleware->handle()
#41 /home/wybuntu/hubtube/app/Http/Middleware/SetLocale.php(51): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#42 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): App\Http\Middleware\SetLocale->handle()
#43 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#44 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#45 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#46 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#47 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#48 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#49 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#50 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#51 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#52 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#53 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#54 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#55 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#56 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#57 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#58 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#59 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#60 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#61 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#62 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#63 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#64 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->{closure:Illuminate\Foundation\Http\Kernel::dispatchToRouter():198}()
#65 /home/wybuntu/hubtube/vendor/livewire/livewire/src/Features/SupportDisablingBackButtonCache/DisableBackButtonCacheMiddleware.php(19): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():168}()
#66 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Livewire\Features\SupportDisablingBackButtonCache\DisableBackButtonCacheMiddleware->handle()
#67 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#68 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#69 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#70 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#71 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#72 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#73 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#74 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#75 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#76 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#77 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#78 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#79 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#80 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#81 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#82 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#83 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():184}:185}()
#84 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#85 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#86 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#87 /home/wybuntu/hubtube/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(397): Illuminate\Foundation\Testing\TestCase->call()
#88 /home/wybuntu/hubtube/tests/Feature/SubscriptionTest.php(29): Illuminate\Foundation\Testing\TestCase->post()
#89 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Factories/TestCaseMethodFactory.php(110): P\Tests\Feature\SubscriptionTest->{closure:/home/wybuntu/hubtube/tests/Feature/SubscriptionTest.php:24}()
#90 [internal function]: P\Tests\Feature\SubscriptionTest->{closure:Pest\Factories\TestCaseMethodFactory::getClosure():102}()
#91 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Concerns/Testable.php(339): call_user_func_array()
#92 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Support/ExceptionTrace.php(26): P\Tests\Feature\SubscriptionTest->{closure:Pest\Concerns\Testable::__callClosure():339}()
#93 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Concerns/Testable.php(339): Pest\Support\ExceptionTrace::ensure()
#94 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Concerns/Testable.php(256): P\Tests\Feature\SubscriptionTest->__callClosure()
#95 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Factories/TestCaseFactory.php(197) : eval()'d code(41): P\Tests\Feature\SubscriptionTest->__runTest()
#96 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestCase.php(1548): P\Tests\Feature\SubscriptionTest->__pest_evaluable_authenticated_user_can_unsubscribe_from_a_channel()
#97 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestCase.php(686): PHPUnit\Framework\TestCase->runTest()
#98 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#99 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestCase.php(516): PHPUnit\Framework\TestRunner->run()
#100 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestCase->run()
#101 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestSuite->run()
#102 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestSuite->run()
#103 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#104 /home/wybuntu/hubtube/vendor/phpunit/phpunit/src/TextUI/Application.php(204): PHPUnit\TextUI\TestRunner->run()
#105 /home/wybuntu/hubtube/vendor/pestphp/pest/src/Kernel.php(103): PHPUnit\TextUI\Application->run()
#106 /home/wybuntu/hubtube/vendor/pestphp/pest/bin/pest(91): Pest\Kernel->handle()
#107 /home/wybuntu/hubtube/vendor/pestphp/pest/bin/pest(99): {closure:/home/wybuntu/hubtube/vendor/pestphp/pest/bin/pest:12}()
#108 /home/wybuntu/hubtube/vendor/bin/pest(119): include('...')
#109 {main}

----------------------------------------------------------------------------------

Pusher error: cURL error 7: Failed to connect to localhost port 8080 after 0 ms: Connection refused (see https://curl.haxx.se/libcurl/c/libcurl-errors.html) for http://localhost:8080/apps/hubtube/events?auth_key=hubtube-key&auth_timestamp=1770923077&auth_version=1.0&body_md5=6d6abf0237bc375009866e2f688197ca&auth_signature=054db8becd1729cd9aef5e37e97c01252d5e504a9599306a85e287434494b338.

  at tests/Feature/SubscriptionTest.php:33
     29▕     $this->post("/channel/{$channel->id}/subscribe");
     30▕
     31▕     // Then unsubscribe
     32▕     $response = $this->delete("/channel/{$channel->id}/subscribe");
  ➜  33▕     $response->assertRedirect();
     34▕
     35▕     $this->assertDatabaseMissing('subscriptions', [
     36▕         'subscriber_id' => $subscriber->id,
     37▕         'channel_id' => $channel->id,

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\SubscriptionTest > user cannot subscribe to themselves
  Expected response status code [201, 301, 302, 303, 307, 308] but received 422.
Failed asserting that false is true.

  at tests/Feature/SubscriptionTest.php:51
     47▕     $user = asUser();
     48▕
     49▕     $response = $this->post("/channel/{$user->id}/subscribe");
     50▕     // Should fail or redirect with error
  ➜  51▕     $response->assertRedirect();
     52▕ });
     53▕

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\UserSettingsTest > user can update profile
  Failed asserting that two strings are identical.
  -'Updated'
  +'Drake'


  at tests/Feature/UserSettingsTest.php:31
     27▕         'bio' => 'Updated bio text',
     28▕     ]);
     29▕
     30▕     $response->assertRedirect();
  ➜  31▕     expect($user->fresh()->first_name)->toBe('Updated');
     32▕     expect($user->fresh()->last_name)->toBe('Name');
     33▕ });
     34▕
     35▕ test('user can update password', function () {

  1   tests/Feature/UserSettingsTest.php:31

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\VideoTest > video owner can access edit page
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests/Feature/VideoTest.php:47
     43▕ test('video owner can access edit page', function () {
     44▕     $user = asUser();
     45▕     $video = Video::factory()->create(['user_id' => $user->id]);
     46▕
  ➜  47▕     $this->get("/videos/{$video->id}/edit")->assertStatus(200);
     48▕ });
     49▕
     50▕ test('non-owner cannot access video edit page', function () {
     51▕     $video = Video::factory()->create();

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\VideoTest > video owner can update video
  Expected response status code [201, 301, 302, 303, 307, 308] but received 403.
Failed asserting that false is true.

  at tests/Feature/VideoTest.php:68
     64▕         'privacy' => 'public',
     65▕         'category_id' => $video->category_id,
     66▕     ]);
     67▕
  ➜  68▕     $response->assertRedirect();
     69▕     expect($video->fresh()->title)->toBe('Updated Title');
     70▕ });
     71▕
     72▕ test('video owner can delete video', function () {

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\VideoTest > authenticated user can like a video
  Expected response status code [201, 301, 302, 303, 307, 308] but received 200.
Failed asserting that false is true.

  at tests/Feature/VideoTest.php:94
     90▕     asUser();
     91▕     $video = Video::factory()->create();
     92▕
     93▕     $response = $this->post("/videos/{$video->id}/like");
  ➜  94▕     $response->assertRedirect();
     95▕ });
     96▕
     97▕ test('authenticated user can dislike a video', function () {
     98▕     asUser();

  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\VideoTest > authenticated user can dislike a video
  Expected response status code [201, 301, 302, 303, 307, 308] but received 200.
Failed asserting that false is true.

  at tests/Feature/VideoTest.php:102
     98▕     asUser();
     99▕     $video = Video::factory()->create();
    100▕
    101▕     $response = $this->post("/videos/{$video->id}/dislike");
  ➜ 102▕     $response->assertRedirect();
    103▕ });
    104▕
    105▕ test('load more videos API returns JSON', function () {
    106▕     Video::factory()->count(5)->create();


  Tests:    14 failed, 1 skipped, 140 passed (272 assertions)
  Duration: 9.60s

wybuntu@Wyatt-Lat7490:~/hubtube$