/**
 * AgoraWebSDK_N-v4.24.2-0-g002485b1-dirty Copyright AgoraInc.
 */

import{EventEmitter as t,setParameter as e,getParameter as s,VERSION as o,retryable as r,checkValidString as n,checkValidNumber as a,wait as i,AgoraRTCErrorCode as c,AgoraRTCError as p,throttleByKey as l,IS_GLOBAL_VERSION as d,BUILD as E,isPageRecording as u,loadInstallId as h,dividePackage as _,networkIndicator as T,NETWORK_STATE as R,DEFAULT_RETRY_CONFIG as S,post as g,postProtobuf as I,AgoraAPITag as O,AgoraAPIName as A,getMessageEncoding as m,appendBuffer as f}from"@agora-js/shared";export{AgoraRTCErrorCode}from"@agora-js/shared";import v from"axios";function P(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var o=s.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function y(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function N(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?y(Object(s),!0).forEach((function(e){P(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):y(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function D(){D=function(t,e){return new s(t,void 0,e)};var t=RegExp.prototype,e=new WeakMap;function s(t,o,r){var n=RegExp(t,o);return e.set(n,r||e.get(t)),b(n,s.prototype)}function o(t,s){var o=e.get(s);return Object.keys(o).reduce((function(e,s){var r=o[s];if("number"==typeof r)e[s]=t[r];else{for(var n=0;void 0===t[r[n]]&&n+1<r.length;)n++;e[s]=t[r[n]]}return e}),Object.create(null))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}(s,RegExp),s.prototype.exec=function(e){var s=t.exec.call(this,e);if(s){s.groups=o(s,this);var r=s.indices;r&&(r.groups=o(r,this))}return s},s.prototype[Symbol.replace]=function(s,r){if("string"==typeof r){var n=e.get(this);return t[Symbol.replace].call(this,s,r.replace(/\$<([^>]+)(>|$)/g,(function(t,e,s){if(""===s)return t;var o=n[e];return Array.isArray(o)?"$"+o.join("$"):"number"==typeof o?"$"+o:""})))}if("function"==typeof r){var a=this;return t[Symbol.replace].call(this,s,(function(){var t=arguments;return"object"!=typeof t[t.length-1]&&(t=[].slice.call(t)).push(o(t,a)),r.apply(this,t)}))}return t[Symbol.replace].call(this,s,r)},D.apply(this,arguments)}const C=new class extends t{constructor(){super(...arguments),P(this,"currentUploadLogID",0)}reportLogUploadError(t){const{errorRange:e}=t;e[e.length-1]&&e[e.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=e[e.length-1],this.emit("REPORT_LOG_UPLOAD",t))}};class U{constructor(t){P(this,"logger",void 0),P(this,"prefixLists",[]),this.logger=t}debug(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.logger.debug(...this.prefixLists,...e)}info(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.logger.info(...this.prefixLists,...e)}warning(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.logger.warning(...this.prefixLists,...e)}error(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.logger.error(...this.prefixLists,...e)}prefix(t){return this.prefixLists.push(t),this}popPrefix(){return this.prefixLists.pop(),this}}function L(){const t=new Date;return t.toTimeString().split(" ")[0]+":"+t.getMilliseconds()}function w(){const t=new Date,e=/((\d+:){2}\d+)/.exec((new Date).toUTCString());return e?(null==e?void 0:e[0])+":"+t.getUTCMilliseconds():t.toTimeString().split(" ")[0]+":"+t.getMilliseconds()}const M={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},W=Date.now(),x=t=>{for(const e in M)if(Object.prototype.hasOwnProperty.call(M,e)&&M[e]===t)return e;return"DEFAULT"};class V{constructor(){P(this,"proxyServerURL",void 0),P(this,"logLevel",M.DEBUG),P(this,"uploadState","collecting"),P(this,"uploadLogWaitingList",[]),P(this,"uploadLogUploadingList",[]),P(this,"uploadErrorCount",0),P(this,"currentLogID",0),P(this,"url",void 0),P(this,"extLog",((t,e)=>{this.appendLogToWaitingList(t,...e)}))}debug(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];const o=[M.DEBUG].concat(e);this.log.apply(this,o)}info(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];const o=[M.INFO].concat(e);this.log.apply(this,o)}warning(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];const o=[M.WARNING].concat(e);this.log.apply(this,o)}warn(){this.warning(...arguments)}error(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];const o=[M.ERROR].concat(e);this.log.apply(this,o)}upload(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];const o=[M.DEBUG].concat(e);this.uploadLog.apply(this,o)}setLogLevel(t){t=Math.min(Math.max(0,t),4),this.logLevel=t}enableLogUpload(){e("UPLOAD_LOG",!0)}disableLogUpload(){e("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(t){this.proxyServerURL=t}prefix(t){return new U(this).prefix(t)}log(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];if(Date.now()-W<100)return void setTimeout((()=>{this.log(...e)}),Date.now()-W);const r=Math.max(0,Math.min(4,e[0]));if(e[0]=L()+" Agora-SDK [".concat(x(r),"]:"),this.appendLogToWaitingList(r,...e),r<this.logLevel)return;const n=L()+" %cAgora-SDK [".concat(x(r),"]:");let a=[];if(!s("USE_NEW_LOG"))switch(r){case M.DEBUG:a=[n,"color: #64B5F6;"].concat(e.slice(1)),console.log.apply(console,a);break;case M.INFO:a=[n,"color: #1E88E5; font-weight: bold;"].concat(e.slice(1)),console.log.apply(console,a);break;case M.WARNING:a=[n,"color: #FB8C00; font-weight: bold;"].concat(e.slice(1)),console.warn.apply(console,a);break;case M.ERROR:a=[n,"color: #B00020; font-weight: bold;"].concat(e.slice(1)),console.error.apply(console,a)}}uploadLog(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];if(Date.now()-W<100)return void setTimeout((()=>{this.uploadLog(...e)}),Date.now()-W);const o=Math.max(0,Math.min(4,e[0]));e[0]=L()+" Agora-SDK [".concat(x(o),"]:"),this.appendLogToWaitingList(o,...e)}appendLogToWaitingList(t){if(!s("UPLOAD_LOG"))return;for(var e=arguments.length,o=new Array(e>1?e-1:0),r=1;r<e;r++)o[r-1]=arguments[r];Array.isArray(o[0])?o[0][0]=w()+" Agora-SDK [".concat(x(t),"]:"):o[0]=w()+" Agora-SDK [".concat(x(t),"]:");let n="";o.forEach((t=>{"object"==typeof t&&(t=JSON.stringify(t)),n+="".concat(t," ")})),this.uploadLogWaitingList.push({payload_str:n,log_level:t,log_item_id:this.currentLogID++}),"uploading"===this.uploadState&&0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}async uploadLogs(){const t=this.uploadLogUploadingList,e={sdk_version:o,process_id:s("PROCESS_ID"),payload:JSON.stringify(t)};return r((async()=>{const t=await v.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(s("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(s("LOG_UPLOAD_SERVER"),"/upload/v1")),e,{responseType:"text"});if("OK"!==t.data){const e=new Error("unexpected upload log response");throw e.response=t,e}}),(()=>(this.uploadLogUploadingList=[],!1)),(e=>{const s={status:-1,message:e.message,errorRange:t.map((t=>t.log_item_id))};return e.response?(s.status=e.response.status,s.data=e.response.data,s.headers=e.response.headers):e.request&&(s.status=e.request.status),C.reportLogUploadError(s),!0}),{timeout:s("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:s("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,s("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then((()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout((()=>this.uploadLogInterval()),s("UPLOAD_LOG_INTERVAL"))})).catch((t=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout((()=>this.uploadLogInterval()),s("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout((()=>this.uploadLogInterval()),s("UPLOAD_LOG_RETRY_INTERVAL_V1"))})))}}const j=new V;let k=function(t){return t.FREE="free",t.UPLOADING="uploading",t}({}),B=function(t){return t[t.MISC=0]="MISC",t[t.INTERNAL_EVENT=1]="INTERNAL_EVENT",t[t.PUBLIC_EVENT=2]="PUBLIC_EVENT",t[t.WEB_EVENT=3]="WEB_EVENT",t[t.INTERNAL_API=4]="INTERNAL_API",t[t.WEB_API=5]="WEB_API",t[t.PUBLIC_API=6]="PUBLIC_API",t}({});function F(t){return n(t.reportId,"params.reportId",0,100,!1),n(t.category,"params.category",0,100,!1),n(t.event,"params.event",0,100,!1),n(t.label,"params.label",0,100,!1),a(t.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}const G={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let J=function(t){return t.PUBLISH="publish",t.SUBSCRIBE="subscribe",t.WS_COMPRESSOR_INIT="ws_compressor_init",t.SESSION_INIT="session_init",t.JOIN_CHOOSE_SERVER="join_choose_server",t.RTE_DETAIL="rte_detail_stats",t.REQ_USER_ACCOUNT="req_user_account",t.JOIN_GATEWAY="join_gateway",t.REJOIN_GATEWAY="rejoin_gateway",t.STREAM_SWITCH="stream_switch",t.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",t.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",t.FIRST_VIDEO_RECEIVED="first_video_received",t.FIRST_AUDIO_RECEIVED="first_audio_received",t.FIRST_VIDEO_DECODE="first_video_decode",t.FIRST_AUDIO_DECODE="first_audio_decode",t.XLA_PEER_FIRST_VIDEO_FRAME="xla_peer_first_video_frame",t.ON_ADD_AUDIO_STREAM="on_add_audio_stream",t.ON_ADD_VIDEO_STREAM="on_add_video_stream",t.ON_UPDATE_STREAM="on_update_stream",t.ON_REMOVE_STREAM="on_remove_stream",t.USER_ANALYTICS="req_user_analytics",t.PC_STATS="pc_stats",t.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",t.AB_TEST="ab_test",t}({}),Y=function(t){return t.SESSION="io.agora.pb.Wrtc.Session",t.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",t.RTE_DETAIL="io.agora.pb.Wrtc.RteDetailStats",t.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",t.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",t.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",t.PUBLISH="io.agora.pb.Wrtc.Publish",t.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",t.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",t.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",t.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",t.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",t.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",t.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",t.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",t.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",t.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",t.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",t.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",t.XLA_PEER_FIRST_VIDEO_FRAME="io.agora.pb.Wrtc.XLAPeerFirstVideoFrame",t.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",t.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",t.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",t.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",t.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",t.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",t.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",t.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",t.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",t.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",t.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",t.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",t.PC_STATS="io.agora.pb.Wrtc.PCStats",t.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",t.AB_TEST="io.agora.pb.Wrtc.ABTest",t}({}),K=function(t){return t[t.WORKER_EVENT=156]="WORKER_EVENT",t[t.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",t}({}),H=function(t){return t[t.SESSION=26]="SESSION",t[t.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",t[t.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",t[t.JOIN_GATEWAY=28]="JOIN_GATEWAY",t[t.PUBLISH=30]="PUBLISH",t[t.SUBSCRIBE=29]="SUBSCRIBE",t[t.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",t[t.STREAM_SWITCH=32]="STREAM_SWITCH",t[t.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",t[t.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",t[t.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",t[t.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",t[t.API_INVOKE=41]="API_INVOKE",t[t.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",t[t.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",t[t.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",t[t.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",t[t.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",t[t.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",t[t.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",t[t.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",t[t.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",t[t.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",t[t.WORKER_EVENT=156]="WORKER_EVENT",t[t.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",t[t.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",t[t.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",t[t.USER_ANALYTICS=1e4]="USER_ANALYTICS",t[t.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",t}({});class Q{constructor(){P(this,"baseInfoMap",new Map),P(this,"proxyServer",void 0),P(this,"eventUploadTimer",void 0),P(this,"setSessionIdTimer",void 0),P(this,"url",void 0),P(this,"sids",new Set),P(this,"backupUrl",void 0),P(this,"_appId",void 0),P(this,"_aid",0),P(this,"keyEventUploadPendingItems",[]),P(this,"normalEventUploadPendingItems",[]),P(this,"apiInvokeUploadPendingItems",[]),P(this,"apiInvokeCount",0),P(this,"apiInvokeLoggedCount",0),P(this,"ltsList",[]),P(this,"lastSendNormalEventTime",Date.now()),P(this,"customReportCounterTimer",void 0),P(this,"customReportCount",0),P(this,"extApiInvoke",(async t=>{for(const e of t){const t=N(N({},e),{},{sid:null,invokeId:++this.apiInvokeCount,tag:O.TRACER});this.sendApiInvoke(t)}})),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),s("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),s("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(t){return this.baseInfoMap.get(t)}setAppId(t){this._appId=t,this._aid=parseInt(t.replace(/[a-fA-F0-9]{8}/g,(t=>{let[e,s]=t;return e+s})),16)||0}reportApiInvoke(t,e,o){e.timeout=e.timeout||6e4,e.reportResult=void 0===e.reportResult||e.reportResult;const r=Date.now();this.apiInvokeCount+=1;const n=this.apiInvokeCount,a=!!s("SHOW_REPORT_INVOKER_LOG"),d=!!s("SHOW_REPORT_USER_INVOKER_LOG"),E=a||d&&e.id;E&&(this.apiInvokeLoggedCount+=1);const u=this.apiInvokeLoggedCount;function h(t,s){if(E){let o="[apiInvoke-".concat(u,"]");if(e.id&&(o+="[".concat(e.id,"]")),e.name&&(o+="[".concat(e.name,"]"),e.name===A.JOIN))return j.info("".concat(o," ").concat(t));j.info("".concat(o," ").concat(t),"start"===t?e.options:s||"")}}const _=()=>({tag:e.tag,invokeId:n,sid:t,name:e.name,apiInvokeTime:r,options:e.options,states:e.states||null});h("start");let T=!1;i(e.timeout).then((()=>{T||(this.sendApiInvoke(N(N({},_()),{},{error:c.API_INVOKE_TIMEOUT,success:!1})),h("timeout"))}));const R=new p(c.UNEXPECTED_ERROR,"".concat(e.name,": this api invoke is end"));return{onSuccess:t=>{const s=()=>{if(T)throw R;return T=!0,this.sendApiInvoke(N(N({},_()),{},{success:!0},e.reportResult&&{result:t})),h("onSuccess"),t};return o?l(s,e.name+"Success",o,(()=>T=!0)):s()},onError:t=>{const s=()=>{if(T)throw t;T=!0,this.sendApiInvoke(N(N({},_()),{},{success:!1,error:t})),h("onFailure",t.toString())};return o?l(s,e.name+"Error",o,(()=>T=!0)):s()}}}_send(t,e,s){this.send({type:t,data:e},s)}_sendApiInvoke(t){return this.sendApiInvoke(t)}sessionInit(t,e){if(this.baseInfoMap.has(t))return;const r=Date.now(),n=this.createBaseInfo(t,r);n.cname=e.cname,n.rteUrl=e.rteUrl;const a=Object.assign({},{willUploadConsoleLog:s("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:d?"global":"oversea",areas:s("AREAS")&&s("AREAS").join(",")},e.extend),{stringUid:i,channelProfile:c,channelMode:p,isABTestSuccess:l,lsid:h,clientRole:_}=e,T=Date.now(),R=N(N({},n),{},{eventType:J.SESSION_INIT,appid:e.appid,browser:navigator.userAgent,buildFormat:e.buildFormat,build:E,lts:T,elapse:T-r,extend:JSON.stringify(a),mode:e.mode,process:s("PROCESS_ID"),appType:s("APP_TYPE"),success:!0,version:o,stringUid:i,channelProfile:c,channelMode:p,isABTestSuccess:l,lsid:h,clientType:u()?42:20,clientRole:_,serviceId:s("PROCESS_ID"),extensionID:s("PLUGIN_INFO").join(",")||"",rteUrl:e.rteUrl,rteSid:e.rteSid});this.send({type:Y.SESSION,data:R},!0)}reportRteDetail(t){const e=this.baseInfoMap.get(t);if(!e)return;const s=e.info,o=Date.now(),r=N(N({},s),{},{eventType:J.RTE_DETAIL,lts:o,success:!0,elapse:o-e.startTime,vid:void 0===s.vid?0:Number(s.vid),ua:navigator.userAgent});this.send({type:Y.RTE_DETAIL,data:r},!0)}joinChooseServer(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info;e.vid&&(o.vid=e.vid);const r=Date.now(),n=N(N({},o),{},{role:e.role,eventType:J.JOIN_CHOOSE_SERVER,lts:r,eventElapse:e.elapse||r-e.lts,chooseServerAddr:e.csAddr,errorCode:e.ec,elapse:r-s.startTime,success:e.succ,chooseServerAddrList:JSON.stringify(e.serverList),uid:e.uid?parseInt(e.uid):null,cid:e.cid?parseInt(e.cid):null,chooseServerIp:e.csIp||"",opid:e.opid,unilbsServerIds:e.unilbsServerIds,extend:e.extend||void 0,isHttp3:e.isHttp3,corssRegionTagReq:e.corssRegionTagReq||void 0,corssRegionTagRes:e.corssRegionTagRes||void 0,ua:navigator.userAgent,resourceTimingInfo:e.resourceTimingInfo||void 0});this.send({type:Y.JOIN_CHOOSE_SERVER,data:n},!0)}reqUserAccount(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N({},o),{},{eventType:J.REQ_USER_ACCOUNT,lts:r,success:e.success,serverAddress:e.serverAddr,stringUid:e.stringUid,uid:e.uid,errorCode:e.errorCode,elapse:e.elapse||r-s.startTime,eventElapse:r-e.lts,extend:JSON.stringify(e.extend)});this.send({type:Y.REQ_USER_ACCOUNT,data:n},!0)}joinGateway(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info;e.vid&&(o.vid=e.vid),o.uid=e.uid,o.cid=e.cid;const r=Date.now(),{firstSuccess:n,addr:a,isProxy:i}=e,c=r-s.startTime,p=N(N({},o),{},{eventType:J.JOIN_GATEWAY,lts:r,gatewayAddr:e.addr,success:e.succ,errorCode:e.ec,errorMsg:e.errorMsg||"",elapse:c,eventElapse:r-e.lts,firstSuccess:n,signalChannel:e.signalChannel,preload:e.preload?1:0,installId:h(),isABTestSuccess:e.isABTestSuccess?1:0,gatewayIp:null,gatewayPort:null,isProxy:i?1:0}),l=p.success?1:0;if(e.succ&&(s.lastJoinSuccessTime=r),a)if("1"===p.signalChannel){const t=D(/(\d+\.\d+\.\d+\.\d+):(\d+)/,{ip:1,port:2}),e=a.match(t);p.gatewayIp=e&&e.groups?e.groups.ip:"",p.gatewayPort=e&&e.groups?e.groups.port:""}else if(i){const t=a.match(/h=(\d{1,3}-){3}\d{1,3}/g),e=a.match(/p=[0-9]{1,6}/g);p.gatewayIp=t&&t.length?t[0].split("=")[1].replace(/-/g,"."):"",p.gatewayPort=e&&e.length?e[0].split("=")[1]:""}else{const t=a.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),e=a.match(/(:|p=)[0-9]{1,6}/g);p.gatewayIp=t&&t.length?t[0].split("//")[1].replace(/-/g,"."):"",p.gatewayPort=e&&e.length?e[0].split(/:|p=/g)[1]:""}if(n)this.send({type:Y.JOIN_GATEWAY,data:p},!0);else{let t={isSuccess:l,port:p.gatewayPort};delete p.success,delete p.eventType,delete p.firstSuccess,delete p.gatewayPort,p.vid=Number(p.vid);const e=Object.assign({},p,t,{eventType:J.REJOIN_GATEWAY});this.send({type:Y.RE_JOIN_GATEWAY,data:e},!0)}}joinChannelTimeout(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=Date.now(),r=N(N({},s.info),{},{lts:o,timeout:e,elapse:o-s.startTime});this.send({type:Y.JOIN_CHANNEL_TIMEOUT,data:r},!0)}publish(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N({},o),{},{eventType:J.PUBLISH,lts:r,eventElapse:e.eventElapse,elapse:r-s.startTime,success:e.succ,errorCode:e.ec,videoName:e.videoName,audioName:e.audioName,screenName:e.screenName,screenshare:e.screenshare,audio:e.audio,video:e.video,p2pid:e.p2pid,publishRequestid:e.publishRequestid});this.send({type:Y.PUBLISH,data:n},!0)}subscribe(t,e,s){const o=this.baseInfoMap.get(t);if(!o)return;const r=o.info,n=Date.now(),a=N(N({},r),{},{eventType:J.SUBSCRIBE,lts:n,eventElapse:e.eventElapse,elapse:n-o.startTime,success:e.succ,errorCode:e.ec,video:e.video,audio:e.audio,subscribeRequestid:e.subscribeRequestid,p2pid:e.p2pid,preSsrc:e.preSsrc?1:0},s&&{extend:JSON.stringify({isMassSubscribe:!0})});"string"==typeof e.peerid?a.peerSuid=e.peerid:a.peer=e.peerid,this.send({type:Y.SUBSCRIBE,data:a},!0)}wsCompressorInit(t){const e=[...this.baseInfoMap.keys()],s=e.length?e[0]:"UnableToGetSid",o=this.baseInfoMap.get(s);if(!o)return;const r=o.info,n=Date.now(),a=N(N({},r),{},{eventType:J.WS_COMPRESSOR_INIT,lts:n,eventElapse:t.eventElapse,elapse:n-o.startTime,status:t.status?1:2});this.send({type:Y.WS_COMPRESSOR_INIT,data:a},!0)}firstXLAPeerFirstVideoFrame(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=e.peerPubStatusMs-(s.lastJoinSuccessTime||r),a=N(N({},o),{},{elapse:r-s.startTime,eventType:J.XLA_PEER_FIRST_VIDEO_FRAME,lts:r,peer:e.peer,width:e.width,height:e.height,ssrc:e.ssrc,p2pid:e.p2pid,peerPublishDuration:e.peerPublishDuration,joinChannelSuccessElapse:n,peerPubStatusMs:e.peerPubStatusMs-e.joinChannelStart,availablePublish:e.peerPublishDuration>n?1:0,preloadStart:Math.max(e.preloadStart-e.joinChannelStart,0),preloadEnd:Math.max(e.preloadEnd-e.joinChannelStart,0),encrypt:Math.max(e.apStart-e.joinChannelStart,0),ap:Math.max(e.apEnd-e.joinChannelStart,0),sua:Math.max(e.suaEnd-e.joinChannelStart,0),beforeConnect:Math.max(e.beforeConnect-e.joinChannelStart,0),peerRecevier:Math.max(e.peerReceiver-e.joinChannelStart,0),ice:Math.max(e.ice-e.joinChannelStart,0),pc:Math.max(e.pc-e.joinChannelStart,0),signalConnected:Math.max(e.signalConnected-e.joinChannelStart,0),joinReq:Math.max(e.joinReq-e.joinChannelStart,0),joinRes:Math.max(e.joinRes-e.joinChannelStart,0),userJoinNotify:Math.max(e.userJoinNotify-e.joinChannelStart,0),videoSsrcNotify:Math.max(e.videoAddNotify-e.joinChannelStart,0),subscribeDelayMs:Math.max(e.subscribeStart-e.videoAddNotify,0),subscribeStart:Math.max(e.subscribeStart-e.joinChannelStart,0),subscribeEnd:Math.max(e.subscribeEnd-e.joinChannelStart,0),firstReceived:Math.max(e.firstReceived-e.joinChannelStart,0),firstDecoded:Math.max(e.firstDecoded-e.joinChannelStart,0),firstPreRender:Math.max(e.firstPreRender-e.joinChannelStart,0),firstRender:Math.max(e.firstRender-e.joinChannelStart,0),playDelayMs:Math.max(e.playStart-e.subscribeEnd,0),playStart:Math.max(e.playStart-e.joinChannelStart,0),playEnd:Math.max(e.playEnd-e.joinChannelStart,0),isPreSub:e.isPreSub?1:0,isPrePc:e.isPrePc?1:0,isPreInstantVideo:e.isPreInstantVideo?1:0,firstReceivedEncodedFrame:e.firstReceivedEncodedFrame?Math.max(e.firstReceivedEncodedFrame-e.joinChannelStart,0):void 0,frameType:e.frameType||"",rtpTimestamp:e.rtpTimestamp||0,framePayloadType:e.framePayloadType||0,frameDataLength:e.frameDataLength||0,mimeType:e.mimeType||""});this.send({type:Y.XLA_PEER_FIRST_VIDEO_FRAME,data:a},!0)}firstRemoteVideoDecode(t,e,s,o){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,a=Date.now(),i=N(N(N({},n),o),{},{elapse:a-r.startTime,eventType:e,lts:a,firstDecodeFrame:Math.max((o.firstFrame||a)-r.startTime,0),apEnd:Math.max(o.apEnd-r.startTime,0),apStart:Math.max(o.apStart-r.startTime,0),joinGwEnd:Math.max(o.joinGwEnd-r.startTime,0),joinGwStart:Math.max(o.joinGwStart-r.startTime,0),pcEnd:Math.max(o.pcEnd-r.startTime,0),pcStart:Math.max(o.pcStart-r.startTime,0),subscriberEnd:Math.max(o.subscriberEnd-r.startTime,0),subscriberStart:Math.max(o.subscriberStart-r.startTime,0),videoAddNotify:Math.max(o.videoAddNotify-r.startTime,0)});this.send({type:s,data:i},!0)}firstRemoteFrame(t,e,s,o){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,a=Date.now(),i=N(N(N({},n),o),{},{elapse:a-r.startTime,eventType:e,lts:a});this.send({type:s,data:i},!0)}abTest(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N(N({},o),e),{},{vid:void 0===o.vid?0:Number(o.vid),elapse:r-s.startTime,eventType:J.AB_TEST,lts:r});this.send({type:Y.AB_TEST,data:n},!0)}pcStats(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N(N({},o),e),{},{vid:void 0===o.vid?0:Number(o.vid),elapse:r-s.startTime,eventType:J.PC_STATS,lts:r,preallocation:e.preallocation?1:0});this.send({type:Y.PC_STATS,data:n},!0)}updateRemoteRTPCapabilities(t,e){if(t){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N(N({},o),e),{},{vid:void 0===o.vid?0:Number(o.vid),eventType:J.UPDATE_REMOTE_RTPCAPABILITIES,lts:r});this.send({type:Y.UPDATE_REMOTE_RTPCAPABILITIES,data:n},!0)}}onGatewayStream(t,e,s,o){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,a=Date.now(),i=N(N(N({},n),o),{},{eventType:e,lts:a});this.send({type:s,data:i},!0)}streamSwitch(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N({},o),{},{eventType:J.STREAM_SWITCH,lts:r,isDual:e.isdual,elapse:r-s.startTime,success:e.succ});this.send({type:Y.STREAM_SWITCH,data:n},!0)}requestProxyAppCenter(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N({},o),{},{eventType:J.REQUEST_PROXY_APPCENTER,lts:r,eventElapse:r-e.lts,elapse:r-s.startTime,APAddr:e.APAddr,workerManagerList:e.workerManagerList,response:e.response,errorCode:e.ec,success:e.succ});this.send({type:Y.REQUEST_PROXY_APPCENTER,data:n},!0)}requestProxyWorkerManager(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N({},o),{},{eventType:J.REQUEST_PROXY_WORKER_MANAGER,lts:r,eventElapse:r-e.lts,elapse:r-s.startTime,workerManagerAddr:e.workerManagerAddr,response:e.response,errorCode:e.ec,success:e.succ});this.send({type:Y.REQUEST_PROXY_WORKER_MANAGER,data:n},!0)}setProxyServer(t){this.proxyServer=t,t?j.debug("reportProxyServerurl: ".concat(t)):j.debug("disable reportProxyServerurl: ".concat(t))}peerPublishStatus(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N({},o),{},{subscribeElapse:e.subscribeElapse,peer:e.peer,peerPublishDuration:Math.max(e.audioPublishDuration,e.videoPublishDuration),audiotag:e.audioPublishDuration>0?1:-1,videotag:e.videoPublishDuration>0?1:-1,lts:r,elapse:r-s.startTime,joinChannelSuccessElapse:r-(s.lastJoinSuccessTime||r),peerPublishDurationVideo:e.videoPublishDuration,peerPublishDurationAudio:e.audioPublishDuration});this.send({type:Y.PEER_PUBLISH_STATUS,data:n},!0)}workerEvent(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N(N({},o),e),{},{elapse:r-s.startTime,lts:r,productType:"WebRTC"});_(n,"payload",1300).forEach((t=>this.send({type:Y.WORKER_EVENT,data:t},!0)))}apworkerEvent(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N(N({},o),e),{},{elapse:r-s.startTime,lts:r});this.send({type:Y.AP_WORKER_EVENT,data:n},!0)}joinWebProxyAP(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N(N({},o),e),{},{elapse:r-s.startTime,lts:r,extend:e.extend||void 0});this.send({type:Y.JOIN_WEB_PROXY_AP,data:n},!0)}WebSocketQuit(t,e){const s=this.baseInfoMap.get(t);if(!s)return;const o=s.info,r=Date.now(),n=N(N(N({},o),e),{},{elapse:r-s.startTime,lts:r});this.send({type:Y.WEBSOCKET_QUIT,data:n},!0)}async sendCustomReportMessage(t,e){if(this.customReportCount+=e.length,this.customReportCount>s("CUSTOM_REPORT_LIMIT"))throw new p(c.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval((()=>{this.customReportCount=0}),5e3));const o=Date.now(),r=e.map((e=>({type:Y.USER_ANALYTICS,data:N(N({sid:t},e),{},{lts:o})})));try{s("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(r):await this.postDataToStatsCollector(r)}catch(t){throw j.error("send custom report message failed",t.toString()),new p(c.CUSTOM_REPORT_SEND_FAILED,t.message)}}sendApiInvoke(t){const e=s("NOT_REPORT_EVENT");if(t.tag&&e.includes&&e.includes(t.tag))return!1;if(null===t.sid)return this.apiInvokeUploadPendingItems.push(t),!1;const o=this.baseInfoMap.get(t.sid);if(!o)return this.apiInvokeUploadPendingItems.push(t),!1;const{cname:r,uid:n,cid:a}=o.info;let i;if(t.lts=t.lts||Date.now(),t.error)if(t.error instanceof p){const{code:e,message:s}=t.error;i=e||(s||t.error.toString())}else i=t.error.toString();const c={invokeId:t.invokeId,sid:t.sid,cname:r,cid:a,uid:n,lts:t.lts,success:t.success,elapse:t.lts-o.startTime,execElapse:t.lts-t.apiInvokeTime,apiName:t.name,options:t.options?JSON.stringify(t.options):void 0,execStates:t.states?JSON.stringify(t.states):void 0,execResult:t.result?JSON.stringify(t.result):void 0,errorCode:t.error?i:void 0,errorMsg:t.error?JSON.stringify(t.error):void 0};return this.send({type:Y.API_INVOKE,data:c},!1),!0}addSid(t){this.sids.add(t)}removeSid(t){this.sids.delete(t)}appendSessionId(){const t=this.apiInvokeUploadPendingItems;if(0===t.length)return;const e=Array.from(this.sids).find((t=>null!==t));e&&t.forEach((t=>{t&&(t.sid=e,this.sendApiInvoke(Object.assign({},t)))})),t.length=0}send(t,e){if(e)return this.keyEventUploadPendingItems.push(t),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(t),this.normalEventUploadPendingItems.length>s("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(t,e){const o=[],r=[];for(;t.length;){const e=t.shift();o.length<20?o.push(e):r.push(e)}t.push(...r);for(const t of[...o])-1!==this.ltsList.indexOf(t.data.lts)?(t.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(t.data.lts)):(this.ltsList.push(t.data.lts),this.ltsList.sort(((t,e)=>t-e)));e||(this.lastSendNormalEventTime=Date.now());return s("ENABLE_EVENT_REPORT")?(o.length&&(s("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(o):this.postDataToStatsCollector(o)).catch((t=>o=>{s("EVENT_REPORT_RETRY")&&(e?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(t):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(t),this.normalEventUploadPendingItems.length>s("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-s("NORMAL_EVENT_QUEUE_CAPACITY")),j.warning("report: drop normal events"))))})(o)),t):t}async postDataToStatsCollector2(t){T.networkState===R.OFFLINE&&await Promise.race([T.onlineWaiter,i(2*S.maxRetryTimeout)]);const e=t=>{let e=new Uint8Array;return t.forEach((t=>{const s=m(JSON.stringify(t.data)),o=new ArrayBuffer(5),r=(t=>{let e=0;return Object.entries(Y).forEach((s=>{let[o,r]=s;r===t.type&&(e=H[o])})),e})(t),n=new DataView(o);n.setUint16(0,s.byteLength,!0),n.setUint8(2,255&r),n.setUint8(3,r>>>8&255),n.setUint8(4,r>>>16&255),e=f(e,new Uint8Array(o)),e=f(e,s)})),e},o="event";let r=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(s("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(o):"https://".concat(s("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(o);for(let n=0;n<2;n+=1){1===n&&(r=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(s("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(o):"https://".concat(s("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(o));try{await g(r,{timeout:1e4,data:e(t),headers:N(N({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(t){if(1===n)throw t;continue}return}}async postDataToStatsCollector(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=(t=>{const e=t&&t.data.sid&&this.baseInfoMap.get(t.data.sid);return e&&e.info.vid&&+e.info.vid||0})(t[0]),r=o?void 0:this._aid,n={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:t.map((t=>JSON.stringify(t))),vid:o,aid:r};T.networkState===R.OFFLINE&&await Promise.race([T.onlineWaiter,i(2*S.maxRetryTimeout)]);const a=e?"/events/proto-raws":"/events/messages";let c=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(s("EVENT_REPORT_DOMAIN"),"&p=").concat(s("STATS_COLLECTOR_PORT"),"&d=").concat(a):"https://".concat(s("EVENT_REPORT_DOMAIN"),":").concat(s("STATS_COLLECTOR_PORT")).concat(a));for(let t=0;t<2;t+=1){1===t&&(c=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(s("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(s("STATS_COLLECTOR_PORT"),"&d=").concat(a):"https://".concat(s("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(s("STATS_COLLECTOR_PORT")).concat(a)));try{e?await I(c,{timeout:1e4,data:n}):await g(c,{timeout:1e4,data:n})}catch(e){if(1===t)throw e;continue}return}}createBaseInfo(t,e){const s=Object.assign({},G);return s.sid=t,this.baseInfoMap.set(t,{info:s,startTime:e}),s}reportResourceTiming(t,e){const s=performance.getEntriesByName(t),o=s[s.length-1];o&&this.reportApiInvoke(e,{name:"Client.resourceTiming",options:o,tag:O.TRACER}).onSuccess()}}function X(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,s,o){const r=o.value;if("function"==typeof r){const n=t.className||e.__className__||("AgoraRTCClient"===e.constructor.name?"Client":e.constructor.name);o.value=function(){for(var e,o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];let c=a;if(t.argsMap)try{c=t.argsMap(this,...a)}catch(t){j.warning(t),c=[]}try{JSON.stringify(c)}catch(t){j.warning("arguments for method ".concat(n,".").concat(String(s)," not serializable for apiInvoke.")),c=[]}const p=(t.report||q).reportApiInvoke(this._sessionId||null,{id:this._clientId||(null===(e=this.store)||void 0===e?void 0:e.clientId)||this._ID,name:"".concat(n,".").concat(String(s)),options:c,tag:O.TRACER,reportResult:t.reportResult},t.throttleTime);try{const e=r.apply(this,a);return e instanceof Promise?e.then((e=>(p.onSuccess(t.reportResult&&e),e))).catch((t=>{throw p.onError(t),t})):(p.onSuccess(t.reportResult&&e),e)}catch(t){throw p.onError(t),t}}}return o}}const q=new Q;C.on("REPORT_LOG_UPLOAD",(t=>{t.networkState=T.networkState,q.reportApiInvoke(null,{name:"logUploadError",options:t,tag:O.TRACER}).onSuccess("logUploadError")}));class $ extends p{constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",arguments.length>2?arguments[2]:void 0),P(this,"name","AgoraRTCException")}print(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error";return super.print(t,j)}throw(){super.throw(j)}}export{K as AgoraEventUploadId,V as AgoraLogger,$ as AgoraRTCError,J as AgoraRTCEvent,Q as AgoraRTCEventReport,Y as AgoraRTCEventUploadType,G as EVENT_BASE_TEMPLATE,H as EventNameToID,B as LOG_TYPE,k as LOG_UPLOAD_STATE,X as apiInvoke,F as isEventCustomReportParams,C as logReportBus,j as logger,q as report};
